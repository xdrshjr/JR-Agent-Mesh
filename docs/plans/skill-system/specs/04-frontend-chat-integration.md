# Spec 04: å‰ç«¯èŠå¤©é›†æˆ

## 1. æ¦‚è¿°

å®šä¹‰èŠå¤©ç•Œé¢ä¸­ä¸ Skill ç³»ç»Ÿçš„äº¤äº’ï¼šModel Selector æ çš„ Skill æŸ¥çœ‹æŒ‰é’® + å¼¹çª—ã€é¡¶éƒ¨å·¥å…·æ çš„"ä¿å­˜ä¸º Skill"æŒ‰é’® + å®Œæ•´æµç¨‹ã€ä¼šè¯çº§ Skill æ¿€æ´»ã€‚

## 2. Model Selector æ  â€” Skill æŸ¥çœ‹æŒ‰é’®

### 2.1 æŒ‰é’®ä½ç½®

åœ¨ `src/components/chat/model-selector.tsx` ä¸­ï¼Œåœ¨ Dispatch Mode å¼€å…³**å·¦ä¾§**æ·»åŠ  Skill æŒ‰é’®ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [Anthropic â–¾] [claude-sonnet-4-5 â–¾]    [âš¡Skills] Dispatch â–¡ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æŒ‰é’®æ ·å¼ï¼š**
- ä½¿ç”¨ `Zap`ï¼ˆé—ªç”µï¼‰å›¾æ ‡ from lucide-react
- æ˜¾ç¤º "Skills" æ–‡å­—
- å¦‚æœæœ‰ skill æ¿€æ´»ï¼Œåœ¨æŒ‰é’®æ—æ˜¾ç¤ºæ•°å­— badgeï¼ˆå¦‚ "Skills (3)"ï¼‰
- variant="ghost"ï¼Œä¸ Dispatch Mode å¼€å…³ä¿æŒè§†è§‰ä¸€è‡´

### 2.2 ç‚¹å‡»è¡Œä¸º

ç‚¹å‡»æŒ‰é’®æ‰“å¼€ **SkillViewDialog** å¼¹çª—ã€‚

## 3. SkillViewDialog â€” Skill æŸ¥çœ‹å¼¹çª—

### 3.1 å¼¹çª—å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Active Skills                                   [âœ•]  â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚                                                      â”‚
â”‚ Global Skills                                        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ âš¡ Code Review                              git  â”‚ â”‚
â”‚ â”‚   Review code for quality and security           â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚ âš¡ React Best Practices                    conv  â”‚ â”‚
â”‚ â”‚   Apply React best practices                     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                      â”‚
â”‚ Session Skills                                       â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ No session-specific skills activated             â”‚ â”‚
â”‚ â”‚                                                  â”‚ â”‚
â”‚ â”‚          [+ Add skill to this session]           â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Manage all skills â†’                              â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 åŠŸèƒ½åŒºåŸŸ

**Global Skills åŒºåŸŸï¼š**
- åˆ—å‡ºæ‰€æœ‰ isGlobal=true çš„ skill
- åªè¯»å±•ç¤ºï¼Œä¸å¯åœ¨æ­¤å¤„ä¿®æ”¹å…¨å±€æ¿€æ´»çŠ¶æ€
- ç‚¹å‡» skill åç§°å¯å±•å¼€æŸ¥çœ‹å†…å®¹æ‘˜è¦ï¼ˆå‰ 3 è¡Œï¼‰

**Session Skills åŒºåŸŸï¼š**
- åˆ—å‡ºå½“å‰ä¼šè¯æ¿€æ´»çš„ skillï¼ˆä»…ä¼šè¯çº§ï¼Œä¸é‡å¤æ˜¾ç¤ºå…¨å±€çš„ï¼‰
- æ¯ä¸ª skill å³ä¾§æœ‰"å–æ¶ˆ"æŒ‰é’®ï¼Œç‚¹å‡»å–æ¶ˆä¼šè¯çº§æ¿€æ´»
- åº•éƒ¨ "Add skill to this session" æŒ‰é’®

**Add Skill äº¤äº’ï¼š**

ç‚¹å‡» "+ Add skill to this session" åï¼š
1. å±•ç¤ºæ‰€æœ‰æœªæ¿€æ´»çš„ skill åˆ—è¡¨ï¼ˆæ’é™¤å·²å…¨å±€æ¿€æ´»å’Œå·²ä¼šè¯æ¿€æ´»çš„ï¼‰
2. ç”¨æˆ·ç‚¹å‡»æŸä¸ª skill å³æ¿€æ´»
3. è°ƒç”¨ POST `/api/skills/:id/activate` with conversationId
4. åˆ·æ–°å¼¹çª—å†…å®¹

**åº•éƒ¨é“¾æ¥ï¼š**
- "Manage all skills â†’" è·³è½¬åˆ° Settings é¡µé¢çš„ Skills tab

### 3.3 ç»„ä»¶å±‚çº§

```
SkillViewDialog
â”œâ”€â”€ DialogHeader ("Active Skills")
â”œâ”€â”€ GlobalSkillsSection
â”‚   â””â”€â”€ SkillListItem (Ã—N)
â”œâ”€â”€ SessionSkillsSection
â”‚   â”œâ”€â”€ SkillListItem (Ã—N, with remove button)
â”‚   â””â”€â”€ AddSkillButton â†’ AddSkillDropdown
â””â”€â”€ DialogFooter
    â””â”€â”€ Link to Settings/Skills
```

æ–°å»º `src/components/chat/skill-view-dialog.tsx`ã€‚

## 4. é¡¶éƒ¨å·¥å…·æ  â€” ä¿å­˜ä¸º Skill æŒ‰é’®

### 4.1 æŒ‰é’®ä½ç½®

åœ¨ `src/components/chat/input-area.tsx` çš„å·¥å…·æ ä¸­ï¼Œ"Clear" æŒ‰é’®**å·¦ä¾§**æ·»åŠ ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ§  [Medium â–¾]           [ğŸ’¾ Save as Skill] [ğŸ—‘ Clear]â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ“ â”‚ Type a message...                      â”‚ â–¶ â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æŒ‰é’®æ ·å¼ï¼š**
- ä½¿ç”¨ `BookmarkPlus`ï¼ˆä¹¦ç­¾+ï¼‰å›¾æ ‡ from lucide-react
- æ–‡å­— "Save as Skill"
- variant="ghost", size="sm"
- ä¸ Clear æŒ‰é’®è§†è§‰ä¸€è‡´
- ä»…å½“å½“å‰å¯¹è¯æœ‰æ¶ˆæ¯æ—¶æ‰å¯ç”¨ï¼ˆdisabled çŠ¶æ€æ§åˆ¶ï¼‰

### 4.2 æŒ‰é’®çŠ¶æ€

- **å¯ç”¨æ¡ä»¶**ï¼šå½“å‰å¯¹è¯è‡³å°‘æœ‰ 1 æ¡ç”¨æˆ·æ¶ˆæ¯å’Œ 1 æ¡ assistant æ¶ˆæ¯
- **Loading æ€**ï¼šAI æ­£åœ¨ç”Ÿæˆ skill è‰ç¨¿æ—¶
- **ç¦ç”¨æ¡ä»¶**ï¼šæ— æ¶ˆæ¯ / AI æ­£åœ¨å›å¤ / æ­£åœ¨ç”Ÿæˆè‰ç¨¿

## 5. ä¿å­˜ä¸º Skill â€” å®Œæ•´äº¤äº’æµç¨‹

### 5.1 æµç¨‹å›¾

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant FE as å‰ç«¯
    participant API as REST API
    participant SA as Self-Agent

    U->>FE: ç‚¹å‡» "Save as Skill"
    FE->>FE: æŒ‰é’®å˜ loading
    FE->>API: POST /api/skills/generate { conversationId }
    API->>SA: AI åˆ†æå¯¹è¯å†…å®¹
    SA->>SA: æå–æœ‰ä»·å€¼çš„æœ€ä½³å®è·µ
    SA->>SA: ç”Ÿæˆ skill markdown è‰ç¨¿
    SA-->>API: è¿”å›è‰ç¨¿
    API-->>FE: è¿”å› { draft: { name, description, content } }
    FE->>FE: æ‰“å¼€ SaveSkillDialog å¼¹çª—
    U->>FE: ç¼–è¾‘è‰ç¨¿ï¼ˆåç§°ã€æè¿°ã€å†…å®¹ï¼‰
    U->>FE: ç‚¹å‡» "Save"
    FE->>API: POST /api/skills { name, description, content, conversationId }
    API-->>FE: è¿”å›åˆ›å»ºçš„ skill ä¿¡æ¯
    FE->>FE: æ˜¾ç¤ºæˆåŠŸ toast
    FE->>FE: å…³é—­å¼¹çª—
```

### 5.2 SaveSkillDialog â€” ä¿å­˜ç¡®è®¤å¼¹çª—

æ–°å»º `src/components/chat/save-skill-dialog.tsx`ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Save as Skill                                   [âœ•]  â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚                                                      â”‚
â”‚ Name                                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ React Performance Optimization                   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                      â”‚
â”‚ Description                                          â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Best practices for optimizing React app perf...  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                      â”‚
â”‚ Content                                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ # React Performance Optimization                 â”‚ â”‚
â”‚ â”‚                                                  â”‚ â”‚
â”‚ â”‚ ## Overview                                      â”‚ â”‚
â”‚ â”‚ Apply these best practices when working with     â”‚ â”‚
â”‚ â”‚ React applications to ensure optimal             â”‚ â”‚
â”‚ â”‚ performance.                                     â”‚ â”‚
â”‚ â”‚                                                  â”‚ â”‚
â”‚ â”‚ ## Key Principles                                â”‚ â”‚
â”‚ â”‚ - Use React.memo for expensive components        â”‚ â”‚
â”‚ â”‚ - Prefer useMemo/useCallback for derived data    â”‚ â”‚
â”‚ â”‚ ...                                              â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                      â”‚
â”‚ â˜‘ Activate globally after saving                     â”‚
â”‚                                                      â”‚
â”‚                          [Cancel]  [Save Skill]      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**UI å…ƒç´ ï¼š**
- **Name è¾“å…¥æ¡†**ï¼šAI ç”Ÿæˆçš„åç§°ï¼Œç”¨æˆ·å¯ä¿®æ”¹
- **Description è¾“å…¥æ¡†**ï¼šAI ç”Ÿæˆçš„æè¿°ï¼Œç”¨æˆ·å¯ä¿®æ”¹
- **Content textarea**ï¼šAI ç”Ÿæˆçš„ skill markdown å†…å®¹ï¼Œç”¨æˆ·å¯ä¿®æ”¹
  - ç­‰å®½å­—ä½“ï¼ˆmonospaceï¼‰
  - è¶³å¤Ÿé«˜åº¦ï¼ˆmin-height: 300pxï¼‰ï¼Œå¯æ»šåŠ¨
- **Global æ¿€æ´»å¤é€‰æ¡†**ï¼šé»˜è®¤å‹¾é€‰ï¼Œä¿å­˜åç«‹å³å…¨å±€æ¿€æ´»
- **Cancel / Save Skill æŒ‰é’®**

**äº¤äº’ï¼š**
- å¼¹çª—æ‰“å¼€æ—¶ï¼Œæ‰€æœ‰å­—æ®µå¡«å…… AI ç”Ÿæˆçš„è‰ç¨¿
- ç”¨æˆ·å¯è‡ªç”±ç¼–è¾‘ä»»ä½•å­—æ®µ
- ç‚¹å‡» Save Skillï¼š
  1. éªŒè¯ name ä¸ä¸ºç©º
  2. è°ƒç”¨ POST `/api/skills` ä¿å­˜
  3. å¦‚æœ Global å‹¾é€‰ï¼Œé¢å¤–è°ƒç”¨ PUT `/api/skills/:id/global` { active: true }
  4. æˆåŠŸåå…³é—­å¼¹çª—ï¼Œtoast æç¤º

### 5.3 AI ç”Ÿæˆ Skill çš„æŒ‡ä»¤

åç«¯åœ¨å¤„ç† POST `/api/skills/generate` æ—¶ï¼Œç»™ Self-Agent çš„åˆ†ææŒ‡ä»¤ï¼š

```
è¯·åˆ†æä»¥ä¸‹å¯¹è¯å†…å®¹ï¼Œæå–æœ‰ä»·å€¼çš„æœ€ä½³å®è·µã€æ–¹æ³•è®ºå’Œè§£å†³æ–¹æ¡ˆï¼Œ
å°†å…¶æŠ½è±¡ä¸ºä¸€ä¸ªé€šç”¨çš„ã€å¯å¤ç”¨çš„ Skillã€‚

è¦æ±‚ï¼š
1. è¯†åˆ«å¯¹è¯ä¸­æ ¸å¿ƒçš„çŸ¥è¯†ç‚¹å’Œè§£å†³æ–¹æ¡ˆ
2. å»æ‰ç‰¹å®šäºå½“å‰åœºæ™¯çš„ç»†èŠ‚ï¼Œæç‚¼ä¸ºé€šç”¨è§„åˆ™
3. ç”Ÿæˆç¬¦åˆ Claude Code Skill æ ¼å¼çš„ markdown æ–‡ä»¶
4. åŒ…å«ä»¥ä¸‹éƒ¨åˆ†ï¼š
   - æ ‡é¢˜å’Œæ¦‚è¿°
   - ä½¿ç”¨åœºæ™¯ï¼ˆWhen to Useï¼‰
   - æ ¸å¿ƒæŒ‡å—/è§„åˆ™
   - æ³¨æ„äº‹é¡¹

è¯·ä»¥ JSON æ ¼å¼è¿”å›ï¼š
{
  "name": "Skill åç§°",
  "description": "ä¸€å¥è¯æè¿°",
  "content": "å®Œæ•´çš„ markdown å†…å®¹"
}

å¯¹è¯å†…å®¹ï¼š
---
[æ­¤å¤„é™„åŠ å¯¹è¯çš„æ¶ˆæ¯æ‘˜è¦]
---
```

## 6. ä¼šè¯çº§ Skill æ¿€æ´»çš„çŠ¶æ€åŒæ­¥

### 6.1 WebSocket æ¶ˆæ¯

å½“ä¼šè¯çº§ skill æ¿€æ´»/å–æ¶ˆæ—¶ï¼Œéœ€è¦é€šçŸ¥åç«¯åˆ·æ–°ç³»ç»Ÿæç¤ºã€‚

æ–°å¢æ¶ˆæ¯ç±»å‹ï¼ˆæ·»åŠ åˆ° `shared/types.ts`ï¼‰ï¼š

```
// Client â†’ Server
'chat.set_session_skills'

interface ChatSetSessionSkillsPayload:
    conversationId: string
    skillIds: string[]    // å½“å‰ä¼šè¯æ¿€æ´»çš„ skill ID åˆ—è¡¨
```

åç«¯æ”¶åˆ°æ­¤æ¶ˆæ¯åï¼Œè°ƒç”¨ `selfAgentService.refreshSystemPrompt()` æ›´æ–°ç³»ç»Ÿæç¤ºã€‚

### 6.2 å‰ç«¯çŠ¶æ€

åœ¨ Skill Store ä¸­ç»´æŠ¤ `conversationSkills` çŠ¶æ€ï¼š

```
conversationSkills: {
    "conv-xxx": ["skill-1", "skill-2"],
    "conv-yyy": ["skill-3"],
}
```

åˆ‡æ¢å¯¹è¯æ—¶ï¼Œä» API åŠ è½½è¯¥å¯¹è¯çš„ä¼šè¯çº§ skillã€‚

## 7. ç»„ä»¶æ–‡ä»¶æ¸…å•

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `src/components/chat/skill-view-dialog.tsx` | Skill æŸ¥çœ‹å¼¹çª—ï¼ˆModel Selector æ ï¼‰ |
| `src/components/chat/save-skill-dialog.tsx` | ä¿å­˜ä¸º Skill å¼¹çª—ï¼ˆå«ç¼–è¾‘åŠŸèƒ½ï¼‰ |
| `src/stores/skill-store.ts` | Skill å‰ç«¯çŠ¶æ€ç®¡ç† |

Model Selector å’Œ Input Area æ˜¯ä¿®æ”¹ç°æœ‰æ–‡ä»¶ï¼Œä¸æ–°å»ºã€‚
